function wp = wp_init(traj,t_now,tf,plot_show)

base_gate = [ 0.00  0.00  0.00  0.00  0.00;...
             -0.30 -0.30  0.30  0.30 -0.30;...
             -0.15  0.15  0.15 -0.15 -0.15];
map = [0 0 0]';

switch traj
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'hover'
        N_wp = 2;      
        t = [0 tf];
        
        x = zeros(12,2);
        x(:,1) = [0 ; 0 ; 1 ; zeros(9,1)];
        x(:,2) = [0 ; 0 ; 1 ; zeros(9,1)];
                
        Q_key = [6 6]';
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'climb'
        N_wp = 2;
        t = [0 0.5 tf];
        
        x = zeros(12,2);
        x(:,2) = [0 ; 0 ; 1 ; zeros(3,1) ; 0 ; 0 ; 0.7 ; 0 ; 0 ; 0];
        x(:,3) = [0 ; 0 ; 1 ; zeros(3,1) ; 0 ; 0 ; 0.7 ; 0 ; 0 ; 0];
                
        Q_key = [6 6;...
                 6 6];
             
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'line'
        N_wp = 3;
        t = [0 (1/3)*tf (2/3)*tf tf];
        
        x = zeros(12,3);
        x(:,2) = [0 ; 0 ; 1; zeros(9,1)];
        x(:,3) = [2 ; 0 ; 1; zeros(9,1)];
        x(:,4) = [2 ; 0 ; 1; zeros(9,1)];
        
        Q_key = [6 6;...
                 6 6;...
                 6 6];
             
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'half-square'
        N_wp = 4;
        t = [0 (1/4)*tf (2/4)*tf (3/4)*tf tf];
        
        x = zeros(12,4);
        x(:,2) = [0 ; 0 ; 1; zeros(3,1) ; 0 ; 0 ;  0.7 ; 0 ; 0 ; 0];
        x(:,3) = [0 ; 2 ; 1; zeros(9,1)];
        x(:,4) = [2 ; 2 ; 1; zeros(3,1) ; 0 ; 0 ; -0.7 ; 0 ; 0 ; 0];
        x(:,5) = [2 ; 2 ; 1; zeros(9,1)];
        
        Q_key = [6 6;...
                 6 6;...
                 6 6;...
                 6 6];
             
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'almost-square'
        N_wp = 6;
        t = [0 (1/5)*tf (2/5)*tf (3/5)*tf (4/5)*tf tf];
        
        x = zeros(12,5);
        x(:,2) = [0 ; 0 ; 1; zeros(9,1)];
        x(:,3) = [0 ; 2 ; 1; zeros(9,1)];
        x(:,4) = [2 ; 2 ; 1; zeros(9,1)];
        x(:,5) = [2 ; 0 ; 1; zeros(9,1)];
        x(:,6) = [2 ; 0 ; 1; zeros(9,1)];
        
        Q_key = [6 6;...
                 6 6;...
                 6 6;...
                 6 6;...
                 6 6];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'square'
        N_wp = 6;
        t = [0 (1/6)*tf (2/6)*tf (3/6)*tf (4/6)*tf (5/6)*tf tf]';
        
        x = zeros(12,7);
        x(:,2) = [ 0 ; 0 ; 1; zeros(9,1)];
        x(:,3) = [ 0 ; 2 ; 1; zeros(9,1)];
        x(:,4) = [ 2 ; 2 ; 1; zeros(9,1)];
        x(:,5) = [ 2 ; 0 ; 1; zeros(9,1)];
        x(:,6) = [ 0 ; 0 ; 1; zeros(9,1)];
        x(:,7) = [ 0 ; 0 ; 0; zeros(9,1)];
                
        Q_key = [6 6;...
                 6 6;...
                 6 6;...
                 6 6;...
                 6 6;...
                 6 6];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%        
    case 'slit'
        N_wp = 2;
        t = [0 (1/2)*tf tf];
        
        x = zeros(12,N_wp);
        x(:,1) = [-1.0 ; 0.0 ; 1.0 ; zeros(9,1)];
        x(:,2) = [ 0.0 ; 0.0 ; 1.0 ; 1.0 ; 0.0 ; 0.0 ; 0.3 ; 0.0 ; 0.0 ; zeros(3,1)];    % Tilt (through the hole)
        x(:,3) = [ 1.0 ; 0.0 ; 1.0 ; zeros(9,1)];
                 
        Q_key = [2 3;...
                 6 6];
               
        q0 = sqrt(1-x(7:9,2)'*x(7:9,2));
        quat = [q0 ; x(7:9,2)];
        bRw = quat2rotm(quat');

        map = bRw*base_gate + [0 0 1]';
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%        
    case 'slit v2'
        N_wp = 3;
        t = [0 ((1/2)*tf-0.3) ((1/2)*tf+0.3) tf];
        
        x = zeros(12,N_wp);
        x(:,1) = [-2.0 ; 0.0 ; 1.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; zeros(3,1)];
        x(:,2) = [-0.6 ; 0.0 ; 1.0 ; 2.0 ; 0.0 ; 0.0 ; 0.4 ; 0.0 ; 0.0 ; zeros(3,1)];
        x(:,3) = [ 0.6 ; 0.0 ; 1.0 ; 2.0 ; 0.0 ; 0.0 ; 0.4 ; 0.0 ; 0.0 ; zeros(3,1)];
        x(:,4) = [ 2.0 ; 0.0 ; 1.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; zeros(3,1)];
        x(:,5) = [ 2.0 ; 0.0 ; 1.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; 0.0 ; zeros(3,1)];

        Q_key = [4 3;...
                 4 3;...
                 2 6];
               
        q0 = sqrt(1-x(7:9,2)'*x(7:9,2));
        quat = [q0 ; x(7:9,2)];
        bRw = quat2rotm(quat');

        map = bRw*base_gate + [0 0 1]';
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
    otherwise
        disp('[wp_init]: No trajectory loaded!');
end

wp.gate = base_gate;
wp.t = t_now + t;
wp.x = x;
wp.N_wp = N_wp;
wp.tf = tf;

wp.x_lim = [-8.1 8.1];
wp.y_lim = [-3.2 3.2];
wp.z_lim = [0 3];

wp.Q_key = Q_key;
wp.map = map;

switch plot_show
    case 'plot'
        figure(1)
        clf
        
        
    case 'no plot'
        % Do Nothing
    otherwise
        % Do Nothing
end
